---
layout: post
title: "대퇴골을 활용한 인간의 신장 추정"
tags: [인골, Python]
comments: true
---

작성 중

### 1. 목적

 기말고사가 일찍끝나서 집에서 빈둥거리다 책장에 꽂혀있는 책을 봤다. 2015년 국립김해박물관 기획전시실에서 진행한 <strong>'뼈?뼈!'</strong> 전시의 도록이었다. 책을 대충 넘겨가며 보던 중 재미있어보이는 것을 발견했다. 대퇴골의 길이로 인간의 신장을 추정하는 공식이었는데 무려 세가지나 있었다. 문득 자동으로 계산해주는 프로그램이 있으면 좋을 것 같아서 오랜만에 공부도 할 겸 만들기 시작했다. 

 이 글을 누가 볼까 싶지만 한 가지 당부하자면 <strong>나는 컴퓨터 관련 전공자가 아니다.</strong> 그렇기 때문에 뭔가 전문적인 기술을 얻어가고자 하는 목적이라면 '뒤로가기'를 꾸욱 눌러주면 감사하겠다... 중학교를 다니면서 프로그래밍 언어를 배우긴 했지만 굉장히 초보적인 단계였고, 최근 6년 정도는 거들떠도 안보았다. 뇌를 워밍업한다는 기분으로 간단히 만들어볼 것이다.

### 2. 코드

```
from openpyxl import Workbook
from openpyxl.styles import PatternFill, Border, Side, Alignment, Protection, Font

#Male
def M_pearson(number):
    result = 81.306 + 1.880 * number
    return result

def M_Trotter(number):
    result = 2.15 * number + 72.57
    return result

def M_huzii(number):
    result = (2.47 * (number*10) + 549.01)/10
    return result

#Female
def F_pearson(number):
    result = 72.844 + 1.945 * number
    return result

def F_huzii(number):
    result = (2.24 * (number*10) + 610.43)/10
    return result

wb = Workbook()
ws = wb.active
ws.title = 'result'

count = 2

#Sheet style of Excel
r1c1 = ws.cell(row = 1, column = 1)
r1c1.value = "Number"
r1c1.font = Font(bold=True)
r1c1.alignment = Alignment(horizontal='center')
r1c2 = ws.cell(row = 1, column = 2)
r1c2.value = "Sex"
r1c2.font = Font(bold=True)
r1c2.alignment = Alignment(horizontal='center')
r1c3 = ws.cell(row = 1, column = 3)
r1c3.value = "Femur Length"
r1c3.font = Font(bold=True)
r1c3.alignment = Alignment(horizontal='center')
r1c4 = ws.cell(row = 1, column = 4)
r1c4.value = "Pearson formula"
r1c4.font = Font(bold=True)
r1c4.alignment = Alignment(horizontal='center')
r1c5 = ws.cell(row = 1, column = 5)
r1c5.value = "Huzii formula"
r1c5.font = Font(bold=True)
r1c5.alignment = Alignment(horizontal='center')
r1c6 = ws.cell(row = 1, column = 6)
r1c6.value = "Trotter&Gleser formula"
r1c6.font = Font(bold=True)
r1c6.alignment = Alignment(horizontal='center')

#First Page
print("="*30)
print("="*9 + "femurtotall" + "="*10)
print("="*30)
print(" ")

while True : 
    print("Male : 1\nFemale : 2\nExit : 3")
    print(" ")
    sex = input(">>> ")
    print(" ")
    if sex == '1': #Male
        print("You chose a Male")
        print("You can use Pearson formula, Trotter&Glaser formula, Huzii formula")
        print("Enter to 0, you go to First Page")
        print(" ")
        while True:
            femur = float(input("Input the femur length >>> "))
            if femur != 0:
                pearson_result = M_pearson(femur)
                trotter_result = M_Trotter(femur)
                huzii_result = M_huzii(femur)
                
                #Sheet styles
                number = ws.cell(row = count, column = 1)
                number.value = count - 1
                number.alignment = Alignment(horizontal='center')
                sexinsheet = ws.cell(row = count, column = 2)
                sexinsheet.value = "Male"
                sexinsheet.alignment = Alignment(horizontal='center')
                femur_length = ws.cell(row = count, column = 3)
                femur_length.value = femur
                femur_length.alignment = Alignment(horizontal='center')
                pearsoncell = ws.cell(row = count, column = 4)
                pearsoncell.alignment = Alignment(horizontal='center')
                huziicell = ws.cell(row = count, column = 5)
                huziicell.alignment = Alignment(horizontal='center')
                trottercell = ws.cell(row = count, column = 6)
                trottercell.alignment = Alignment(horizontal='center')

                #Output Result
                pearsoncell.value = pearson_result
                huziicell.value = huzii_result
                trottercell.value = trotter_result

                count += 1

                print("- Pearson formula : %0.3fcm" % pearson_result)
                print("- Huzii formula : %0.3fcm" % huzii_result)
                print("- Trotter&Glaser formula : %0.3fcm" % trotter_result)
                print(" ")

            elif femur == 0 :
                print(" ")
                print("=" * 30)
                print("=" * 2 + "Go to First Page" + "=" * 2)
                print("=" * 30)
                print(" ")
                break

    elif sex == '2': #Female
        print("You chose a Female")
        print("You can use Pearson formula, Huzii formula")
        print("Enter to 0, you go to First Page")
        print(" ")
        while True:
            femur = float(input("Input the femur length >>> "))
            if femur != 0:
                pearson_result = F_pearson(femur)
                huzii_result = F_huzii(femur)
             
                number = ws.cell(row = count, column = 1)
                number.value = count - 1
                number.alignment = Alignment(horizontal='center')
                sex = ws.cell(row = count, column = 2)
                sex.value = "Female"
                sex.alignment = Alignment(horizontal='center')
                femur_length = ws.cell(row = count, column = 3)
                femur_length.value = femur
                femur_length.alignment = Alignment(horizontal='center')
                pearsoncell = ws.cell(row = count, column = 4)
                pearsoncell.alignment = Alignment(horizontal='center')
                huziicell = ws.cell(row = count, column = 5)
                huziicell.alignment = Alignment(horizontal='center')

                #Output Result
                pearsoncell.value = pearson_result
                huziicell.value = huzii_result

                count += 1

                print("- Pearson formula : %0.3fcm"  % pearson_result)
                print("- Huzii formula : %0.3fcm" % huzii_result)
                print(" ")

            elif femur == 0 :
                print(" ")
                print("=" * 30)
                print("=" * 2 + "Go to First Page" + "=" * 2)
                print("=" * 30)
                print(" ")
                break
            
    elif sex == '3': #Exit
        wb.save('/Users/jch/Desktop/result.xlsx')
        print("="*30)
        print("="*11 + "Exit" + "="*10)
        print("="*30)
        print(" ")
        break

    else: #Error
        print(" ")
        print("Error")
        print(" ")
```



### 3. 향후 계획

 CUI로 되어있다보니 만든 내가 아니면 사용하기 힘들 것 같다. 과연 누군가 사용할 일이 있을까 싶지만?? 그래도 혹시 모르니 향후 PyQt를 활용 GUI로 만들어야겠다.

 계산해야하는 자료가 많다면 현재의 방식으로는 오래걸릴 것 같다. Openxl를 활용해서 .xlsx 로 입력받고 .xlsx로 출력하는 형식으로 개편해야겠다.